{% extends 'base.html.twig' %}

{% block title %}Délai activité annuelle{% endblock %}

{% block body %}

<h2 class="title-page mt-5">Délai activité annuelle</h2>

<div class="form-container">
  {{ form_start(form, {'attr': {'class': 'search-form'}}) }}
  <div class="input-grp-tab">{{ form_row(form.date) }}</div>
  <div class="input-grp-tab">{{ form_row(form.num_siret) }}
    {{ form_row(form.utilisateurs) }}
    {{ form_row(form.code_uo) }}</div>
  <div class="input-grp-tab">{{ form_row(form.code_cpv) }}
    {{ form_row(form.code_formation) }}
    {{ form_row(form.tax) }}
  </div>
  <div class="btn-submit">
    {{ form_end(form) }}</div>  
</div>
{% if app.request.method == 'POST' %}
{{dump(achats_delay_all[0]["CountAntInf3"])}}
{{dump(achats_delay_all[0]["Pourcentage_Delai_Inf_3_Jours_Ant"])}}
{{dump(achats_delay_all[0]["CountAntSup3"])}}
{{dump(achats_delay_all[0]["Pourcentage_Delai_Sup_3_Jours_Ant"])}}
<table border=1>
  <thead>
    <th>Délai</th>
    <th>Janvier</th>
    <th>Février</th>
    <th>Mars</th>
    <th>Avril</th>
    <th>Mai</th>
    <th>Juin</th>
    <th>Juillet</th>
    <th>Aout</th>
    <th>Septembre</th>
    <th>Octobre</th>
    <th>Novembre</th>
    <th>Decembre</th>
    <th>Total</th>

    {% for achat in achats %}
    <tr>
      <th>{{ achat.source }}</th>
      <td>{{ achat.Janvier }}</td>
      <td>{{ achat.Février }}</td>
      <td>{{ achat.Mars }}</td>
      <td>{{ achat.Avril }}</td>
      <td>{{ achat.Mai }}</td>
      <td>{{ achat.Juin }}</td>
      <td>{{ achat.Juillet }}</td>
      <td>{{ achat.Aout }}</td>
      <td>{{ achat.Septembre }}</td>
      <td>{{ achat.Octobre }}</td>
      <td>{{ achat.Novembre }}</td>
      <td>{{ achat.Decembre }}</td>
      <td>
        {{ (achat.Janvier + achat.Février + achat.Mars + achat.Avril + achat.Mai + achat.Juin + achat.Juillet + achat.Aout + achat.Septembre + achat.Octobre + achat.Novembre + achat.Decembre) / 12 }}
      </td>
    </tr>
    {% endfor %}
  </thead>
  <tbody>
  </tbody>
</table>
<div class="d-flex w-50 flex-row" data-controller="chartdelay">

<canvas id="delayChart" data-chartdelay-target="delayChart" > </canvas>

</div>

<script>
    var transStat = {{ transStat|json_encode|raw }};
    var notStat = {{notStat|json_encode|raw }};
</script>
{% endif %}
{% endblock %}